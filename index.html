<?php
require_once 'header.php';
?>
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AltKawaiiBox - Главная страница</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="icon" href="../img/AltKawaiiBox_LOGO 1.svg" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
      html, body {
    font-family: 'Poppins', sans-serif;
    margin: 0;
    padding: 0;
    background-color:#20262E;
    color: #E9E8E8;
}

.slider-container {
    position: relative;
    width: 100%;
    max-width: 1100px;
    margin: 100px auto;
    overflow: hidden;
}

.slider-wrapper {
    width: 100%;
    overflow: hidden;
}

.slider {
    display: flex;
    transition: transform 0.5s ease;
    width: 100%;
    height: 100%;
}

.slide {
    min-width: 100%;
    flex-shrink: 0;
}

.slide img {
    width: 100%;
    height: auto;
    display: block;
    object-fit: cover;
}

.slider-nav {
    position: absolute;
    top: 50%;
    width: 100%;
    display: flex;
    justify-content: space-between;
    transform: translateY(-50%);
    padding: 0 20px;
    box-sizing: border-box;
    pointer-events: none;
}

.slider-nav button {
    background: rgba(255, 255, 255, 0.5);
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
    pointer-events: auto;
}

.slider-nav button:hover {
    background: rgba(255, 255, 255, 0.8);
}

.slider-dots {
    display: flex;
    justify-content: center;
    margin-top: 20px;
    gap: 10px;
}

.slider-dots .dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: #ccc;
    border: none;
    cursor: pointer;
    padding: 0;
    transition: background 0.3s;
}

.slider-dots .dot.active {
    background: #555;
}

@media (max-width: 768px) {
    .slider-container {
        margin: 50px auto;
    }
    
    .slider-nav button {
        width: 30px;
        height: 30px;
        font-size: 16px;
    }
    
    .slider-dots .dot {
        width: 10px;
        height: 10px;
    }
}

@media (max-width: 480px) {
    .slider-container {
        margin: 30px auto;
    }
    
    .slider-nav {
        padding: 0 10px;
    }
    
    .slider-nav button {
        width: 25px;
        height: 25px;
        font-size: 14px;
    }
}

.about_us {
    margin: 0 4%;
    display: flex;
    flex-wrap: wrap; 
    align-items: center;
    justify-content: center;
}

.about_left {
    flex: 1 1 70%;
    min-width: 300px; 
}

.about_right_1 {
    margin-top: 125px;
    flex: 1 1 30%;
    min-width: 250px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.about_right_2 {
    display: flex;
    flex-direction: column;
    align-items: center;
    background-color: #CD5888;
    border-radius: 20px;
    padding: 69px 81px;
    font-size: 1.7em;
    font-weight: 600;
    width: 100%;
    box-sizing: border-box;
}

.logo_about {
    height: 200px;
    max-width: 100%;
}


.about_us_p {
    font-size: 36px;
    display: flex;
    justify-content: center;
    padding: 0; 
    margin: 20px 0;
    text-align: center;
}


.about_us_p_long {
    margin: 20px auto;
    text-align: center;
    width: 90%;
    font-size: 1.7em;
}

.hits {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    align-items: center;
    position: relative;
    padding: 20px 0;
}

.hits_p {
    display: flex;
    justify-content:center;
    font-size: 2em;
    width: 100%;
    box-sizing: border-box;
}

.products_flex {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 55px;
    padding: 20px;
}

.products_scrollable {
    display: flex;
    gap: 55px;
    overflow-x: auto;
    scroll-behavior: smooth;
    padding: 20px;
    padding-bottom: 10px;
    -webkit-overflow-scrolling: touch; 
}

.products_scrollable::-webkit-scrollbar {
    display: none;
}

.product_card {
    width: 300px;
    height: 470px;
    flex: 0 0 300px;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    border: solid #CD5888 5px;
    border-radius: 30px;
    padding: 36px;
    box-sizing: border-box;
    background-position: center;
    background-repeat: no-repeat;
    background-size: cover;
    transition: all 0.3s ease;
}

.product_card:hover {
    cursor: pointer;
    border: solid rgba(205, 88, 137, 0);
    background-image: url('img/Rectangle 6 (1).png');
    background-size: 105%;
    background-repeat: no-repeat;
    background-position: center;
}

.product_image img, .catalog_image img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

.product_info {
    width: 100%;
    height: 140px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 10px 0;
    box-sizing: border-box;
}

.product_title {
    margin: 10px 0;
    font-size: 16px;
    line-height: 1.2em;
    height: 2.4em;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
}

.product_price {
    font-size: 200%;
    font-weight: 600;
    color: #CD5888;
}

.product_image {
    background-color: #D9D9D9;
    padding: 32px 12px;
    border-radius: 20px;
    width: 250px;
    height: 170px;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
}

.product_button {
    background: #CD5888;
    color: white;
    padding: 15px 30px;
    border-radius: 15px;
    border: none;
    margin-top: auto;
    cursor: pointer;
    transition: background 0.3s;
}

.product_button:hover {
    background-color: #913175;
}

.catalog_image {
    background-color: #D9D9D9;
    padding: 32px 12px;
    border-radius: 20px;
    width: 250px;
    height: 170px;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    filter: blur(5px);
}

.btn_catalog {
    background: #CD5888;
    color: white;
    padding: 15px 30px;
    border-radius: 15px;
    border: none;
    cursor: pointer;
    transition: background 0.3s;
}

.btn_catalog:hover {
    background-color: #913175;
}

.btn_container_catalog {
    text-align: center;
    margin-top: 180px;
    width: 100%;
}

.products_index {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 55px;
    padding: 20px;
}

.scroll-arrow {
    background-color: #CD5888;
    color: white;
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 24px;
    z-index: 1200;
    transition: background 0.3s ease;
}

.scroll-arrow:hover {
    background-color: #913175;
}

.scroll-left,
.scroll-right {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
}

.scroll-left {
    left: -5%;
}

.scroll-right {
    right: -5%;
}

.hits_slider_wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    max-width: 1920px;
    margin: 0 auto;
    position: relative;
}

.products_slider {
    display: flex;
    transition: transform 0.5s ease;
    gap: 30px;
    align-items: center;
    justify-content: center;
    max-width: 1400px;
    margin: 0 auto;
    overflow: hidden;
    padding-left: 250px; 
}

.products_scrollable_track {
    display: flex;
    gap: 100px;
    transition: transform 0.5s ease;
}

.reviews {
    max-width: 600px;
    margin: 0 auto;
    text-align: center;
    position: relative;
    overflow: hidden;
    padding: 20px 0;
}

.reviews-title {
    font-size: 24px;
    margin-bottom: 20px;
}

.reviews-slider {
    display: flex;
    transition: transform 0.5s ease-in-out;
    width: 100%;
}

.review-card {
    flex: 0 0 100%;
    padding: 20px;
    box-sizing: border-box;
}

.review-image img {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    object-fit: cover;
    margin-bottom: 10px;
}

.review-content {
    text-align: center;
}

.review-user {
    font-size: 18px;
    margin-bottom: 5px;
}

.review-text {
    font-size: 16px;
    color: #555;
}

.reviews-button {
    display: inline-block;
    margin-top: 20px;
    padding: 10px 20px;
    background-color: #CD5888;
    color: #E9E8E8;
    text-decoration: none;
    border-radius: 8px;
    transition: background-color 0.3s;
}

.reviews-button:hover {
    background-color: #913175;
}

.no-reviews {
    text-align: center;
    padding: 20px;
    color: #888;
}

@media(max-width: 1200px) {
    .slider-container {
        max-width: 95%;
        margin: 50px auto;
    }
    .slide {
        width: 50%; 
    }
    .products_slider {
        padding-left: 20px;
    }
    .scroll-left {
        left: 2%;
    }
    .scroll-right {
        right: 2%;
    }
}

@media(max-width: 768px) {
    .about_us {
        flex-direction: column;
        align-items: center;
        margin: 0 10px;
    }

    .about_left, .about_right_1, .about_right_2 {
        flex: 1 1 100%;
        width: 100%;
        margin: 20px 0;
        padding: 0 10px;
    }

    .about_us_p {
        font-size: 28px;
        padding: 0 10px;
    }

    .about_us_p_long {
        font-size: 1.4em;
        width: 100%;
    }

    .hits {
        flex-direction: column;
        align-items: center;
        margin: 20px 0;
    }

    .product_card {
        width: 80%;
        height: auto;
        padding: 20px;
    }

    .products_scrollable {
        padding: 10px 0;
    }

    .scroll-arrow {
        width: 35px;
        height: 35px;
        font-size: 20px;
    }
}
    </style>
</head>
<body>
    <?php 
    $connect = include 'connect.php';
    ?>
    <main>
<div class="slider-container">
    <div class="slider">
        <div class="slide"><img src="img/slider_3.svg" alt="Slide 1"></div>
        <div class="slide"><img src="img/slider_2.svg" alt="Slide 2"></div>
        <div class="slide"><img src="img/slider_1.svg" alt="Slide 3"></div>
    </div>
    
    <div class="slider-nav">
        <button class="prev" aria-label="Previous slide">❮</button>
        <button class="next" aria-label="Next slide">❯</button>
    </div>
    
    <div class="slider-dots">
        <button class="dot active" data-slide="0" aria-label="Go to slide 1"></button>
        <button class="dot" data-slide="1" aria-label="Go to slide 2"></button>
        <button class="dot" data-slide="2" aria-label="Go to slide 3"></button>
    </div>
</div>

        <script>
document.addEventListener('DOMContentLoaded', () => {
    let currentSlide = 0;
    const slider = document.querySelector('.slider');
    const dots = document.querySelectorAll('.dot');
    const slides = document.querySelectorAll('.slide');
    const totalSlides = slides.length;
    let slideInterval;

    const goToSlide = (n) => {
        currentSlide = (n + totalSlides) % totalSlides;
        slider.style.transform = `translateX(-${currentSlide * 100}%)`;
        dots.forEach(dot => dot.classList.toggle('active', 
            parseInt(dot.dataset.slide) === currentSlide));
    };

    const nextSlide = () => goToSlide(currentSlide + 1);
    const prevSlide = () => goToSlide(currentSlide - 1);

    const startSlider = () => {
        slideInterval = setInterval(nextSlide, 5000);
    };

    const resetInterval = () => {
        clearInterval(slideInterval);
        startSlider();
    };

    document.querySelector('.next').addEventListener('click', () => {
        nextSlide();
        resetInterval();
    });

    document.querySelector('.prev').addEventListener('click', () => {
        prevSlide();
        resetInterval();
    });

    dots.forEach(dot => {
        dot.addEventListener('click', () => {
            goToSlide(parseInt(dot.dataset.slide));
            resetInterval();
        });
    });

    startSlider();
});
        </script>
        <div class="about_us">
            <div class="about_left">
                <p class="about_us_p"><b>О нас</b></p>
                <p class="about_us_p_long"><b>Мы создаём не просто магазин, а уютное пространство для тех, кто живёт в ритме аниме, альтернативной эстетики и неоновых грёз.
                Мы тщательно отбираем лучшие аниме-товары, вдохновлённые японской поп-культурой, городскими трендами и атмосферой ночного Токио.<br>
                Здесь каждый продукт — как портал в любимую вселенную: фигурки, вкусняшки, канцелярия и стильный мерч ждут своего героя.<br>
                Kawaii, но по-нашему.<br>С вниманием к деталям, с душой и без клише.</b></p>
            </div>
            <div class="about_right_1">
                <div class="about_right_2">
                    <img src="img/AltKawaiiBox_LOGO 1.svg" alt="AltKawaiiBox" class="logo_about">
                    <a href="aboutus.php">Узнать больше</a>
                </div>
            </div>
        </div>
    
    <p class="hits_p"><b>Хиты продаж</b></p>
    <div class="hits">

            <div class="products_index">
                <?php
                $sql = "SELECT * FROM products LIMIT 4";
                $result = $connect->query($sql);

                if ($result->num_rows > 0) {
                    while($row = $result->fetch_assoc()) {
                        echo '
                        <div class="product_card">
                            <div class="product_image" onclick="location.href=`product.php`">
                                <img src="'.$row['img'].'">
                            </div>
                            <div class="product_info">
                                <h3 class="product_title">'.($row['name']).'</h3>
                                <div class="product_price">'.$row['price'].' ₽</div>
                            </div>
                            <a href="cart.php" class="product_button">Добавить в корзину</a>
                        </div>';
                    }
                } else {
                    echo '<div class="no-products">Товары не найдены</div>';
                }
                ?>
            </div>

    </div>
      
    <p class="hits_p"><b>Отзывы</b></p>
    <div class="reviews">
        <div class="reviews-slider" id="reviewsSlider">
            <?php
            $sql = "SELECT *, r.id AS ID, u.user_name AS user_name, u.last_name AS last_name, u.avatar AS avatar
                    FROM reviews r
                    JOIN users u ON r.user_id = u.id
                    ORDER BY r.created_at DESC LIMIT 3";
            $result = $connect->query($sql);

            if ($result->num_rows > 0):
                while ($row = $result->fetch_assoc()):
            ?>
                <div class="review-card">
                    <div class="review-image">
                        <img src="../avatars/<?= htmlspecialchars($row['avatar']) ?>" alt="<?= htmlspecialchars($row['user_name']) ?>">
                    </div>
                    <div class="review-content">
                        <h3 class="review-user"><?= htmlspecialchars($row['user_name']) ?></h3>
                        <p class="review-text"><?= htmlspecialchars($row['text']) ?></p>
                    </div>
                </div>
            <?php endwhile; ?>
        </div>

        <a href="reviews.php" class="reviews-button">Перейти ко всем отзывам</a>

        <?php else: ?>
            <div class="no-reviews">Отзывы не найдены</div>
        <?php endif; ?>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const reviewsslider = document.getElementById('reviewsSlider');
            const cards = reviewsslider.querySelectorAll('.review-card');
            let currentIndex = 0;

            if (cards.length <= 1) return; 

            setInterval(() => {
                currentIndex = (currentIndex + 1) % cards.length;
                reviewsslider.style.transform = `translateX(-${currentIndex * 100}%)`;
            }, 5000); 
        });
    </script>
</main>
    <?php
    include 'footer.php';
    ?>
</body>
</html>